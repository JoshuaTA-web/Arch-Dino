<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Arch-Dino</title>
  <style>
    canvas {
      background: #f0f0f0;
      display: block;
      margin: 0 auto;
      border: 2px solid #333;
    }
    #restartBtn {
      display: none;
      margin: 10px auto;
      padding: 10px 20px;
      background-color: #333;
      color: #fff;
      border: none;
      font-size: 16px;
      cursor: pointer;
    }
    #scoreBoard {
      text-align: center;
      font-family: sans-serif;
      font-size: 18px;
      margin-top: 10px;
    }
  </style>
</head>
<body>

<canvas id="gameCanvas" width="800" height="300"></canvas>
<div id="scoreBoard">Score: <span id="score">0</span></div>
<button id="restartBtn">Restart Game</button>

<script>
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');
  const restartBtn = document.getElementById('restartBtn');
  const scoreDisplay = document.getElementById('score');

  let dino = { x: 50, y: 250, width: 50, height: 50, vy: 0, gravity: 1.5, isJumping: false };
  let obstacles = [];
  let score = 0;
  let gameOver = false;
  let image = new Image();
  image.src = 'archdino.png';

  function resetGame() {
    dino.y = 250;
    dino.vy = 0;
    obstacles = [];
    score = 0;
    gameOver = false;
    restartBtn.style.display = 'none';
    loop();
  }

  function createObstacle() {
    const types = ['box', 'cone', 'sign', 'chair'];
    const type = types[Math.floor(Math.random() * types.length)];

    obstacles.push({
      x: canvas.width,
      y: 260,
      width: 30,
      height: 40,
      type: type
    });
  }

  function drawObstacles() {
    obstacles.forEach(obs => {
      switch (obs.type) {
        case 'box':
          ctx.fillStyle = '#555';
          ctx.fillRect(obs.x, obs.y, obs.width, obs.height);
          break;
        case 'cone':
          ctx.fillStyle = '#d95f02';
          ctx.beginPath();
          ctx.moveTo(obs.x, obs.y + obs.height);
          ctx.lineTo(obs.x + obs.width / 2, obs.y);
          ctx.lineTo(obs.x + obs.width, obs.y + obs.height);
          ctx.closePath();
          ctx.fill();
          break;
        case 'sign':
          ctx.fillStyle = '#1b9e77';
          ctx.fillRect(obs.x, obs.y, obs.width, obs.height);
          ctx.fillStyle = '#fff';
          ctx.font = '10px sans-serif';
          ctx.fillText('!', obs.x + 8, obs.y + 25);
          break;
        case 'chair':
          ctx.fillStyle = '#7570b3';
          ctx.fillRect(obs.x, obs.y + 10, obs.width, 10); // seat
          ctx.fillRect(obs.x + 5, obs.y + 20, 5, 20);     // leg 1
          ctx.fillRect(obs.x + 20, obs.y + 20, 5, 20);    // leg 2
          break;
      }

      obs.x -= 5;
    });

    obstacles = obstacles.filter(obs => obs.x + obs.width > 0);
  }

  function detectCollision() {
    for (let obs of obstacles) {
      if (
        dino.x < obs.x + obs.width &&
        dino.x + dino.width > obs.x &&
        dino.y < obs.y + obs.height &&
        dino.y + dino.height > obs.y
      ) {
        return true;
      }
    }
    return false;
  }

  function drawDino() {
    ctx.drawImage(image, dino.x, dino.y, dino.width, dino.height);
  }

  function loop() {
    if (gameOver) return;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Dino physics
    dino.y += dino.vy;
    dino.vy += dino.gravity;
    if (dino.y > 250) {
      dino.y = 250;
      dino.vy = 0;
      dino.isJumping = false;
    }

    drawDino();
    drawObstacles();

    if (detectCollision()) {
      gameOver = true;
      restartBtn.style.display = 'block';
      return;
    }

    score++;
    scoreDisplay.innerText = Math.floor(score / 10);

    if (score % 150 === 0) {
      createObstacle();
    }

    requestAnimationFrame(loop);
  }

  document.addEventListener('keydown', function (e) {
    if (e.code === 'Space' && !dino.isJumping) {
      dino.vy = -20;
      dino.isJumping = true;
    }
  });

  restartBtn.addEventListener('click', resetGame);

  // Start
  image.onload = function () {
    loop();
  };
</script>

</body>
</html>
